/*! http://github.com/raganwald/allong.es 2013-04-09 (c) 2012-2013 Reg Braithwaite MIT Licensed */
(function(n){function t(n){var t,r,u,e,i,l,o,a,c;if(u=[],t=n,i=t.split(/\s*->\s*/m),i.length>1)for(;i.length;)t=i.pop(),u=i.pop().split(/\s*,\s*|\s+/m),i.length&&i.push("(function("+u+"){return ("+t+")})");else if(t.match(/\b_\b/))u="_";else if(r=t.match(/^\s*(?:[+*\/%&|\^\.=<>]|!=)/m),e=t.match(/[+\-*\/%&|\^\.=<>!]\s*$/m),r||e)r&&(u.push("$1"),t="$1"+t),e&&(u.push("$2"),t+="$2");else for(o=n.replace(/(?:\b[A-Z]|\.[a-zA-Z_$])[a-zA-Z_$\d]*|[a-zA-Z_$][a-zA-Z_$\d]*\s*:|this|arguments|'(?:[^'\\]|\\.)*'|"(?:[^"\\]|\\.)*"/g,"").match(/([a-z_$][a-z_$\d]*)/gi)||[],a=0,c=o.length;c>a;a++)l=o[a],u.indexOf(l)>=0||u.push(l);return Function(u,"return ("+t+")")}function r(n){return"function"==typeof n?n:"string"==typeof n&&/^[_a-zA-Z]\w*$/.test(n)?function(){var t,r,u;return r=arguments[0],t=arguments.length>=2?M.call(arguments,1):[],(u=r[n]).call.apply(u,[r].concat(M.call(t)))}:"string"==typeof n?t(n):"function"==typeof n.lambda?n.lambda():"function"==typeof n.toFunction?n.toFunction():void 0}function u(){var n,t,r,u,e=arguments[0],i=M.call(arguments,1);for(t=0;i.length>t;++t){r=i[t],u=r.except||[],u.push("except");for(n in r)0>u.indexOf(n)&&r.hasOwnProperty(n)&&(e[n]=r[n])}return e}function e(n){return n.reduce(function(n,t){return n.unshift(t),n},[])}function i(n){return n()}function l(n){return function t(r){return null==r?t:n(r)}}function o(n){return function t(r,u){return null==r?t:null==u?l(function(t){return n(r,t)}):n(r,u)}}function a(n){return function t(r,u,e){return null==r?t:null==u?o(function(t,u){return n(r,t,u)}):null==e?l(function(t){return n(r,u,t)}):n(r,u,e)}}function c(n){return function t(r,u,e,i){return null==r?t:null==u?a(function(t,u,e){return n(r,t,u,e)}):null==e?o(function(t,e){return n(r,u,t,e)}):null==i?l(function(t){return n(r,u,e,t)}):n(r,u,e,i)}}function f(n,t,r){function u(){var u=M.call(arguments,0,arguments.length),i=u.indexOf(void 0)>=0?u.indexOf(void 0):u.length,l=t.concat(u.slice(0,i)),o=l.concat(r),a=o.length,c=e-a;return 0>=c?n.apply(this,o):f(n,l,r)}t||(t=[]),r||(r=[]);var e=n.length,i=e-t.length-r.length;return E>i?C[i](u):S(i,u)}function s(n,t){return n.apply(this,t)}function p(n,t){var r=n.length-t.length;return n.length>0&&r>0?I(r,function(r){return n.apply(this,t.concat(r))}):n.apply(this,t)}function h(n,t){var r=n.length-t.length;return n.length>0&&r>0?I(r,function(r){return n.apply(this,r.concat(t))}):n.apply(this,t)}function g(n){return 1===n?function(n){return[n]}:2===n?function(n,t){return[n,t]}:3===n?function(n,t,r){return[n,t,r]}:I(function(n){return n})}function v(n,t){n=r(n);var u=n.length;return 1!==u&&(n=l(n)),null==t?function(t){return j.call(t,n)}:j.call(t,n)}function y(n,t){n=r(n);var u=n.length;return 1!==u&&(n=l(n)),null==t?y(t,n):Z.call(t,n)}function m(n){return function(t){return Z.call(t,function(t){return Array.isArray(t)?innerSoak(t):n(t)})}}function d(n){return n=r(n),function(){var t;if(0!==arguments.length){for(t=0;arguments.length>t;++t)if(null==arguments[t])return;return n.apply(this,arguments)}}}function _(n,t){function u(t){return"function"==typeof t&&t(n),n}return t=r(t),void 0===t?u:u(t)}function b(n){return n=r(n),function(){return n.apply(this,arguments),this}}function A(n){return n=r(n),function(t){return t=r(t),T(st(n),t)}}function x(n){n=r(n);var t,u=!1;return t=n.name?function(){return this.__once__||(this.__once__={}),this.__once__[n.name]?!0:(this.__once__[n.name]=!0,!1)}:function(){return u?!0:(u=!0,!1)},function(){return t.call(this)?void 0:n.apply(this,arguments)}}function w(n,t){n=r(n);var u={};return t||(t=function(n){return JSON.stringify(n)}),function(){var r=t.call(this,arguments);return u[r]||(u[r]=n.apply(this,arguments))}}function F(n){return function t(){return void 0!==arguments[0]?t.call(arguments[0]):(u(this,n),this)}}function W(n){return function(t){function r(){var n=this instanceof r?this:new r;return t.apply(n,arguments)}return r.prototype=u(new t,n),r}}function $(n,t,u){n=r(n);var e;return u&&(n=pt(n)),e=function(){return n.apply(t,arguments)},e.unbound=function(){return n},e}function L(n){n=r(n);var t=M.call(arguments,1);return function(r){return n.apply(r,t)}}function N(n,t){return null==t?function(t){return n[t]}:n[t]}function z(n,t){return null==t?function(t){return t[n]}:t[n]}function O(n){return this instanceof O?(this.closure=n,void 0):new O(n)}function R(n){var t=I(function(t){for(var r=n.apply(this,t);r instanceof O;)r=r.force();return r});return t.__trampolined_fn=n,t}var n=this,M=Array.prototype.slice,Z=Array.prototype.map,j=Array.prototype.filter,q={es:{}};2>"ab".split(/a*/).length&&"undefined"!=typeof console&&null!==console&&console.log("Warning: IE6 split is not ECMAScript-compliant.  This breaks '->1'");var I=function(){function n(n){var t=n.length;return 1>t?n:1===t?function(){return n.call(this,M.call(arguments,0))}:function(){var r=arguments.length,u=M.call(arguments,0,t-1),e=Math.max(t-r-1,0),i=Array(e),l=M.call(arguments,n.length-1);return n.apply(this,u.concat(i).concat([l]))}}var t={};return function(u,e){null==e?(e=r(u),u=0):e=r(e);var i=e.length;if(0===u)return n(e);if(u>=i){var l,o=i-1,a=""+u+"-"+o;if(null==t[a]){for(var c=Array(u),f=0;u>f;++f)c[f]="__"+f;var s=c.join();if(i>1){var p=c.slice(0,i-1).join();l="return function ("+s+") { return fn.call("+p+", [].slice.call(arguments,"+(i-1)+")); };"}else l="return function ("+s+") { return fn.call(this, [].slice.call(arguments, 0)); };";t[a]=Function(["fn"],l)}return t[a](e)}throw"not supported yet"}}(),S=function(){var n={};return function t(u,e){if(null==n[u]){for(var i=Array(u),l=0;u>l;++l)i[l]="__"+l;var o=i.join(),a="return function ("+o+") { return fn.apply(this, arguments); };";n[u]=Function(["fn"],a)}return null==e?function(n){return t(u,n)}:n[u](r(e))}}(),C=[i,l,o,a,c],E=C.length;u(q.es,{curryWithLeftAndRight:f}),u(q.es,{variadic:I,unvariadic:S,unary:l,binary:o,ternary:a,quaternary:c});var T=I(function T(n){n=n.map(r);var t,u,e;if(0===n.length)return function(){};if(1===n.length)return n[0];if(2===n.length)return t=n[0],u=t.length,e=n[1],1===u?function(n){return t(e(n))}:2===u?function(n,r){return t(e(n),r)}:3===u?function(n,r,u){return t(e(n),r,u)}:I(function(n,r){t.apply(this,[e(n)].concat(r))});var t=n[0],i=M.call(n,1);return T.call(this,t,T.apply(this,i))});u(q.es,{compose:T});var D=function(){function n(n){return I(function(t){return n.apply(this,e(t))})}function t(n){return function t(r){return null==r?t:n(r)}}function i(n){return function r(u,e){return null==u?r:null==e?t(function(t){return n(t,u)}):n(e,u)}}function l(n){return function r(u,e,l){return null==u?r:null==e?i(function(t,r){return n(t,r,u)}):null==l?t(function(t){return n(t,e,u)}):n(l,e,u)}}function o(n){return function r(u,e,o,a){return null==u?r:null==e?l(function(t,r,e){return n(t,r,e,u)}):null==o?i(function(t,r){return n(t,r,e,u)}):null==a?t(function(t){return n(t,o,e,u)}):n(a,o,e,u)}}function a(n,t){function r(){var r=M.call(arguments,0,arguments.length),l=r.indexOf(void 0)>=0?r.indexOf(void 0):r.length;return g=t.concat(r.slice(0,l)),argsLength=g.length,i=u-argsLength,0>=i?n.apply(this,e(g)):a(n,g)}t||(t=[]);var u=n.length,i=u-t.length;return f>i?c[i](r):S(i,r)}var c=[n,t,i,l,o],f=c.length;return u(I(function(n,t){n=r(n);var u=n.length,e=f>u?c[u](n):a(n);return 0===t.length?e:e.apply(this,t)}),{unary:t,binary:i,ternary:l,quaternary:o,callWithLeftFlipped:a})}(),J=l(D);u(q.es,{callFlipped:D,flip:J});var K=D(T);u(q.es,{sequence:K});var P=I(function(n,t){return f(n,t,[])}),B=l(P),G=P(s),H=u(I(G),{unary:l,binary:o,ternary:a,quaternary:c}),Q=J(s),U=P(p),V=I(p),X=J(p),Y=J(h),nt=P(h),tt=I(h),rt=I(function(n,t){return f(n,[],t)}),ut=o(P),et=J(ut),it=o(rt),lt=J(it),ot=I(function(n,t){return t===[]?function(t){return t[n].bind(t)}:function(r){return Function.prototype.bind.apply(r[n],[r].concat(t))}}),at=I(function(n,t){var r=n.length,u=t.length;return I(function(e){var i=e.length,l=Math.max(r-i,0);return e=e.concat(t.slice(u-l)),n.apply(this,e)})});u(q.es,{applyNow:G,callNow:H,call:P,callLeft:P,callRight:rt,applyNowFlipped:Q,applyLeftNow:U,callLeftNow:V,applyLeftNowWith:X,applyRightNow:nt,callRightNow:tt,applyRightNowWith:Y,callFirst:ut,callLast:it,callFirstWith:et,callLastWith:lt,bound:ot,defaults:at,args:g,curry:B});var ct=o(function ct(n,t){t=r(t);var u=t.length;return 1!==u&&(t=l(t)),Z.call(n,t)}),y=J(ct),m=o(function(n,t){return t=r(t),Z.call(n,function(n){return Array.isArray(n)?m(n,t):t(n)})}),ft=J(m);u(q.es,{map:ct,mapWith:y,filterWith:v,deepMap:m,deepMapWith:ft});var st=function(n){return n=r(n),function(){return n.apply(this,arguments),arguments[0]}};u(q.es,{maybe:d,tap:_,fluent:b,returnFirst:st,tee:A,once:x,memoized:w}),u(q.es,{mixin:F,classDecorator:W});var pt=function pt(n){return n=r(n),n.unbound?pt(n.unbound()):n},ht=T(y,z),gt=J(ht),vt=I(function(n,t){return I(function(r,u){var e=r[n];return e.apply(r,t.concat(u))})});u(q.es,{bind:$,unbind:pt,invoke:L,get:N,getWith:z,send:vt,pluckWith:ht,pluck:gt}),O.prototype.force=function(){return this.closure()};var yt=I(function(n,t){var r=this;return n.__trampolined_fn instanceof Function?new O(function(){return n.__trampolined_fn.apply(r,t)}):new O(function(){return n.apply(r,t)})});u(q.es,{trampoline:R,tailCall:yt,Thunk:O}),function(n){function t(n,t,u){var e,i;for(t=r(t),e=void 0!==u?u:n(),i=n();null!=i;)e=t.call(i,e,i),i=n();return e}function e(n,t){var u=x;return t=r(t),function(){return u===x?u=n:null!=u?u=t.call(u,u):u}}function i(n,t){var u,e,i=n;return t=r(t),function(){return null!=i?(u=t.call(i,i),e=u[1],i=null!=e?u[0]:void 0,e):void 0}}function a(n,t,u){var e=u;return t=r(t),function(){return element=n(),null==element?element:e=void 0===e?element:t.call(element,e,element)}}function c(n,t,u){var e,i=u;return t=r(t),function(){return element=n(),null==element?element:void 0===i?i=element:(e=t.call(element,i,element),i=e[0],e[1])}}function f(n,t){return t=r(t),function(){var r;return r=n(),null!=r?t.call(r,r):void 0}}function s(n,t){return t=r(t),function(){var r;for(r=n();null!=r;){if(t.call(r,r))return r;r=n()}return void 0}}function p(n,t){return t=r(t),s(n,function(n){return!t(n)})}function h(n,t){return t=r(t),s(n,t)()}function g(n,t,r){for(var u=0;t-->0;)n();return null!=r?function(){return r>=++u?n():void 0}:n}function v(n,t){return g(n,0,null==t?1:t)}function y(n){var t=0;return function(){return n[t++]}}function m(n){var t,r,u;return t=0,u=[],r=function(){var e,i;return e=n[t++],e instanceof Array?(u.push({array:n,index:t}),n=e,t=0,r()):void 0===e?u.length>0?(i=u.pop(),n=i.array,t=i.index,r()):void 0:e}}function d(n){return function(){return n}}function _(n,t,r){return function(){var u;return n>t?void 0:(u=n,n+=r,u)}}function b(n,t,r){return function(){var u;return t>n?void 0:(u=n,n-=r,u)}}function A(n,t,r){return null==n?_(1,1/0,1):null==t?_(n,1/0,1):null==r?t>=n?_(n,t,1):b(n,t,1):r>0?_(n,t,r):0>r?b(n,t,Math.abs(r)):k(n)}var x={},w=at(o(g),1),F=l(A);u(n.es,{iterators:{accumulate:a,accumulateWithReturn:c,fold:t,unfold:e,unfoldWithReturn:i,map:f,select:s,reject:p,filter:s,find:h,slice:g,drop:w,take:v,FlatArrayIterator:y,RecursiveArrayIterator:m,constant:d,K:d,numbers:F,range:A}})}(q),"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=q),exports.allong=q):n.allong=q}).call(this);